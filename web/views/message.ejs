<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Message des rÃ©sultats - Arki Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="layout">
    <%- include('sidebar') %>
    <main class="main-content">
      <div class="page-header">
        <h1>ğŸ“ Message des rÃ©sultats</h1>
        <p>Personnalisez le message publiÃ© lors de /publish-votes</p>
      </div>

      <% if (success) { %>
        <div class="alert alert-success">âœ… <%= success %></div>
      <% } %>
      <% if (error) { %>
        <div class="alert alert-error">âŒ <%= error %></div>
      <% } %>

      <form method="POST" action="/message">
        <div class="card">
          <div class="card-header">
            <h2>ğŸ“¢ Texte d'introduction</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="introText">Message d'introduction (aprÃ¨s le titre)</label>
              <textarea id="introText" name="introText" rows="3"><%= settings.message.introText %></textarea>
              <p class="help-text">AffichÃ© juste aprÃ¨s le titre "RÃ©sultats des votes de [mois]"</p>
            </div>
            <div class="form-group">
              <label for="creditText">Message de crÃ©dit des diamants</label>
              <textarea id="creditText" name="creditText" rows="2"><%= settings.message.creditText %></textarea>
              <p class="help-text">Indique aux joueurs que les diamants sont crÃ©ditÃ©s. Supporte le Markdown Discord (**gras**, etc.)</p>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>ğŸ† Textes des packs (Top 3)</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="pack1Text">Texte 1Ã¨re place</label>
              <input type="text" id="pack1Text" name="pack1Text" value="<%= settings.message.pack1Text %>">
              <p class="help-text">Le rÃ´le Top Votant sera automatiquement ajoutÃ© aprÃ¨s ce texte</p>
            </div>
            <div class="form-group">
              <label for="pack2Text">Texte 2Ã¨me place</label>
              <input type="text" id="pack2Text" name="pack2Text" value="<%= settings.message.pack2Text %>">
            </div>
            <div class="form-group">
              <label for="pack3Text">Texte 3Ã¨me place</label>
              <input type="text" id="pack3Text" name="pack3Text" value="<%= settings.message.pack3Text %>">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>ğŸ“ Lien mÃ©mo et pied de page</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="memoText">Texte du lien mÃ©mo</label>
              <input type="text" id="memoText" name="memoText" value="<%= settings.message.memoText %>">
              <p class="help-text">Texte affichÃ© avant le lien vers les rÃ©compenses</p>
            </div>
            <div class="form-group">
              <label for="dinoShinyText">Texte de transition Dino Shiny</label>
              <input type="text" id="dinoShinyText" name="dinoShinyText" value="<%= settings.message.dinoShinyText %>">
              <p class="help-text">Petit texte en bas du message annonÃ§ant le tirage Dino</p>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>ğŸ¦– Roulette Dino Shiny</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="dinoTitle">Titre de la roue Dino</label>
              <input type="text" id="dinoTitle" name="dinoTitle" value="<%= settings.message.dinoTitle %>" maxlength="20">
              <p class="help-text">Texte au centre de la roue Dino Shiny (max 20 caractÃ¨res)</p>
            </div>
            <div class="form-group">
              <label for="dinoWinText">Message de victoire Dino</label>
              <textarea id="dinoWinText" name="dinoWinText" rows="2"><%= settings.message.dinoWinText %></textarea>
              <p class="help-text">Message de fÃ©licitations pour le gagnant. Supporte le Markdown Discord.</p>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>ğŸ‘ï¸ AperÃ§u du message</h2>
          </div>
          <div class="card-body">
            <div class="preview-box">
              <p class="preview-line"><strong>ğŸ† RÃ©sultats des votes de [MOIS] ğŸ†</strong></p>
              <p class="preview-line preview-dim" id="previewIntro"><%= settings.message.introText %></p>
              <p class="preview-line preview-dim">ğŸ’ <span id="previewCredit"><%= settings.message.creditText %></span></p>
              <br>
              <p class="preview-line"><strong>1</strong> - <strong>Joueur1</strong></p>
              <p class="preview-line preview-dim">Votes : 45 | Gains : 4 500 ğŸ’</p>
              <p class="preview-line preview-dim">+ <span id="previewPack1"><%= settings.message.pack1Text %></span> + rÃ´le @TopVotant</p>
              <p class="preview-line"><strong>2</strong> - <strong>Joueur2</strong></p>
              <p class="preview-line preview-dim">Votes : 32 | Gains : 3 200 ğŸ’</p>
              <p class="preview-line preview-dim">+ <span id="previewPack2"><%= settings.message.pack2Text %></span></p>
              <p class="preview-line">...</p>
              <hr style="border-color: var(--border); margin: 12px 0;">
              <p class="preview-line preview-dim"><span id="previewMemo"><%= settings.message.memoText %></span> â¡ï¸ [lien]</p>
              <p class="preview-line preview-small"><span id="previewDino"><%= settings.message.dinoShinyText %></span></p>
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">ğŸ’¾ Sauvegarder le message</button>
      </form>

      <script>
        document.getElementById('introText').addEventListener('input', e => {
          document.getElementById('previewIntro').textContent = e.target.value;
        });
        document.getElementById('creditText').addEventListener('input', e => {
          document.getElementById('previewCredit').textContent = e.target.value;
        });
        document.getElementById('pack1Text').addEventListener('input', e => {
          document.getElementById('previewPack1').textContent = e.target.value;
        });
        document.getElementById('pack2Text').addEventListener('input', e => {
          document.getElementById('previewPack2').textContent = e.target.value;
        });
        document.getElementById('memoText').addEventListener('input', e => {
          document.getElementById('previewMemo').textContent = e.target.value;
        });
        document.getElementById('dinoShinyText').addEventListener('input', e => {
          document.getElementById('previewDino').textContent = e.target.value;
        });
      </script>
    </main>
  </div>
</body>
</html>
