<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Param√®tres - Arki Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="layout">
    <%- include('sidebar') %>
    <main class="main-content">
      <div class="page-header">
        <h1>‚öôÔ∏è Param√®tres</h1>
        <p>Configuration des canaux, r√¥les, emojis et API</p>
      </div>

      <% if (success) { %>
        <div class="alert alert-success">‚úÖ <%= success %></div>
      <% } %>
      <% if (error) { %>
        <div class="alert alert-error">‚ùå <%= error %></div>
      <% } %>

      <form method="POST" action="/settings">
        <div class="card">
          <div class="card-header">
            <h2>üè† Serveur Discord</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="guildId">ID du serveur</label>
              <input type="text" id="guildId" name="guildId" value="<%= settings.guild.guildId %>" required>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="resultsChannelId">Canal des r√©sultats</label>
                <input type="text" id="resultsChannelId" name="resultsChannelId" value="<%= settings.guild.resultsChannelId %>" required>
                <p class="help-text">ID du canal o√π sont publi√©s les r√©sultats des votes</p>
              </div>
              <div class="form-group">
                <label for="adminLogChannelId">Canal admin / logs</label>
                <input type="text" id="adminLogChannelId" name="adminLogChannelId" value="<%= settings.guild.adminLogChannelId %>" required>
                <p class="help-text">ID du canal pour les rapports de distribution</p>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="topVoterRoleId">R√¥le Top Votant</label>
                <input type="text" id="topVoterRoleId" name="topVoterRoleId" value="<%= settings.guild.topVoterRoleId %>" required>
                <p class="help-text">ID du r√¥le attribu√© au 1er votant</p>
              </div>
              <div class="form-group">
                <label for="modoRoleId">R√¥le Modo</label>
                <input type="text" id="modoRoleId" name="modoRoleId" value="<%= settings.guild.modoRoleId %>" required>
                <p class="help-text">ID du r√¥le qui peut utiliser les commandes admin</p>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>üé® Emojis personnalis√©s</h2>
          </div>
          <div class="card-body">
            <p class="help-text" style="margin-bottom: 16px;">Format Discord : <code>&lt;a:nom:ID&gt;</code> pour anim√© ou <code>&lt;:nom:ID&gt;</code> pour statique</p>
            <div class="form-row">
              <div class="form-group">
                <label for="logo">Logo</label>
                <input type="text" id="logo" name="logo" value="<%= settings.style.logo %>">
              </div>
              <div class="form-group">
                <label for="fireworks">Feux d'artifice</label>
                <input type="text" id="fireworks" name="fireworks" value="<%= settings.style.fireworks %>">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="sparkly">Diamant / Sparkly</label>
                <input type="text" id="sparkly" name="sparkly" value="<%= settings.style.sparkly %>">
              </div>
              <div class="form-group">
                <label for="animeArrow">Fl√®che anim√©e</label>
                <input type="text" id="animeArrow" name="animeArrow" value="<%= settings.style.animeArrow %>">
              </div>
            </div>
            <div class="form-group">
              <label for="arrow">Fl√®che</label>
              <input type="text" id="arrow" name="arrow" value="<%= settings.style.arrow %>">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>üì° Options</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label class="toggle-label">
                <input type="checkbox" name="everyonePing" value="true" <%= settings.style.everyonePing ? 'checked' : '' %>>
                <span class="toggle-text">Ping @everyone lors de la publication des r√©sultats</span>
              </label>
            </div>
            <div class="form-group">
              <label for="memoUrl">URL du m√©mo des r√©compenses</label>
              <input type="text" id="memoUrl" name="memoUrl" value="<%= settings.style.memoUrl %>">
              <p class="help-text">Lien Discord vers le message listant les r√©compenses</p>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>üîó API</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="topserveursRankingUrl">URL API TopServeurs</label>
              <input type="text" id="topserveursRankingUrl" name="topserveursRankingUrl" value="<%= settings.api.topserveursRankingUrl %>" required>
              <p class="help-text">URL compl√®te de l'API de classement TopServeurs</p>
            </div>
            <div class="form-group">
              <label for="timezone">Fuseau horaire</label>
              <input type="text" id="timezone" name="timezone" value="<%= settings.api.timezone %>">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>üîÑ Aliases de joueurs</h2>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label for="aliases">Aliases (format : nom_topserveurs=nom_discord, un par ligne)</label>
              <textarea id="aliases" name="aliases" rows="6" placeholder="ancien_nom=nouveau_nom&#10;joueur123=JoueurDiscord"><%= Object.entries(settings.aliases || {}).map(([k, v]) => k + '=' + v).join('\n') %></textarea>
              <p class="help-text">Permet de lier un pseudo TopServeurs √† un pseudo Discord quand ils sont diff√©rents</p>
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">üíæ Sauvegarder les param√®tres</button>
      </form>
    </main>
  </div>
</body>
</html>
